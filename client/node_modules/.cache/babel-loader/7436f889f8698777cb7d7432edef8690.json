{"ast":null,"code":"const mysql = require('mysql');\n\nconst pool = require('../../../sql/connection');\n\nconst {\n  handleSQLError\n} = require('../../../sql/error'); //GET\n\n\nconst justDislikes = (req, res) => {\n  let sql = 'SELECT dislikeId AS id, item, spoonId FROM dislikes WHERE active=1 AND username=?';\n  sql = mysql.format(sql, [req.user]);\n  pool.query(sql, (err, row) => {\n    if (err) return handleSQLError(res, err);\n    return res.json(row);\n  });\n}; //POST\n\n\nconst addDislike = (req, res) => {\n  const {\n    item,\n    spoon\n  } = req.body;\n  let sql = 'INSERT INTO dislikes (username, item, spoonId) VALUES (?, ?, ?)';\n  sql = mysql.format(sql, [req.user, item, spoon]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.json({\n      dislikeId: results.insertId\n    });\n  });\n}; //PUT\n\n\nconst removeDislike = (req, res) => {\n  const {\n    entryId\n  } = req.params;\n  let sql = 'UPDATE dislikes SET active=0 WHERE dislikeId=? AND username=?';\n  sql = mysql.format(sql, [entryId, req.user]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.status(204).json();\n  });\n};\n\nmodule.exports = {\n  justDislikes,\n  addDislike,\n  removeDislike\n};","map":{"version":3,"sources":["/Users/moonbox/Documents/capstone/pantrypal/controller/users/tastes/dislikes.js"],"names":["mysql","require","pool","handleSQLError","justDislikes","req","res","sql","format","user","query","err","row","json","addDislike","item","spoon","body","results","dislikeId","insertId","removeDislike","entryId","params","status","module","exports"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,yBAAD,CAApB;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAqBF,OAAO,CAAC,oBAAD,CAAlC,C,CAEA;;;AACA,MAAMG,YAAY,GAAG,CAACC,GAAD,EAAMC,GAAN,KAAc;AAEjC,MAAIC,GAAG,GAAC,mFAAR;AAEAA,EAAAA,GAAG,GAACP,KAAK,CAACQ,MAAN,CAAaD,GAAb,EAAiB,CAACF,GAAG,CAACI,IAAL,CAAjB,CAAJ;AAEAP,EAAAA,IAAI,CAACQ,KAAL,CAAWH,GAAX,EAAgB,CAACI,GAAD,EAAMC,GAAN,KAAc;AAC5B,QAAGD,GAAH,EAAQ,OAAOR,cAAc,CAACG,GAAD,EAAMK,GAAN,CAArB;AACR,WAAOL,GAAG,CAACO,IAAJ,CAASD,GAAT,CAAP;AACD,GAHD;AAKD,CAXD,C,CAaA;;;AACA,MAAME,UAAU,GAAG,CAACT,GAAD,EAAMC,GAAN,KAAc;AAE/B,QAAM;AAACS,IAAAA,IAAD;AAAOC,IAAAA;AAAP,MAAgBX,GAAG,CAACY,IAA1B;AAEA,MAAIV,GAAG,GAAC,iEAAR;AAEAA,EAAAA,GAAG,GAACP,KAAK,CAACQ,MAAN,CAAaD,GAAb,EAAiB,CAAEF,GAAG,CAACI,IAAN,EAAYM,IAAZ,EAAkBC,KAAlB,CAAjB,CAAJ;AAEAd,EAAAA,IAAI,CAACQ,KAAL,CAAWH,GAAX,EAAgB,CAACI,GAAD,EAAMO,OAAN,KAAkB;AAChC,QAAGP,GAAH,EAAQ,OAAOR,cAAc,CAACG,GAAD,EAAMK,GAAN,CAArB;AACR,WAAOL,GAAG,CAACO,IAAJ,CAAU;AAAEM,MAAAA,SAAS,EAAED,OAAO,CAACE;AAArB,KAAV,CAAP;AACD,GAHD;AAKD,CAbD,C,CAeA;;;AACA,MAAMC,aAAa,GAAG,CAAChB,GAAD,EAAMC,GAAN,KAAc;AAElC,QAAM;AAAEgB,IAAAA;AAAF,MAAajB,GAAG,CAACkB,MAAvB;AAEA,MAAIhB,GAAG,GAAC,+DAAR;AAEAA,EAAAA,GAAG,GAACP,KAAK,CAACQ,MAAN,CAAaD,GAAb,EAAiB,CAACe,OAAD,EAAUjB,GAAG,CAACI,IAAd,CAAjB,CAAJ;AAEAP,EAAAA,IAAI,CAACQ,KAAL,CAAWH,GAAX,EAAgB,CAACI,GAAD,EAAMO,OAAN,KAAkB;AAChC,QAAIP,GAAJ,EAAS,OAAOR,cAAc,CAACG,GAAD,EAAMK,GAAN,CAArB;AACT,WAAOL,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBX,IAAhB,EAAP;AACD,GAHD;AAID,CAZD;;AAeAY,MAAM,CAACC,OAAP,GAAiB;AAChBtB,EAAAA,YADgB;AAEhBU,EAAAA,UAFgB;AAGhBO,EAAAA;AAHgB,CAAjB","sourcesContent":["const mysql = require('mysql')\nconst pool = require('../../../sql/connection')\nconst { handleSQLError } = require('../../../sql/error')\n\n//GET\nconst justDislikes = (req, res) => {\n\n  let sql='SELECT dislikeId AS id, item, spoonId FROM dislikes WHERE active=1 AND username=?'\n\n  sql=mysql.format(sql,[req.user])\n\n  pool.query(sql, (err, row) => {\n    if(err) return handleSQLError(res, err)\n    return res.json(row); \n  })  \n\n} \n\n//POST\nconst addDislike = (req, res) => {\n\n  const {item, spoon} = req.body\n\n  let sql='INSERT INTO dislikes (username, item, spoonId) VALUES (?, ?, ?)'\n\n  sql=mysql.format(sql,[ req.user, item, spoon])\n\n  pool.query(sql, (err, results) => {\n    if(err) return handleSQLError(res, err)\n    return res.json( { dislikeId: results.insertId} )\n  })  \n\n}\n\n//PUT\nconst removeDislike = (req, res) => {\n  \n  const { entryId} = req.params\n\n  let sql='UPDATE dislikes SET active=0 WHERE dislikeId=? AND username=?'\n\n  sql=mysql.format(sql,[entryId, req.user])\n\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err)\n    return res.status(204).json();\n  })\n}\n\n\nmodule.exports = {\n justDislikes,\n addDislike, \n removeDislike\n}"]},"metadata":{},"sourceType":"script"}