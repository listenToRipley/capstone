{"ast":null,"code":"const mysql = require('mysql');\n\nconst pool = require('../../../sql/connection');\n\nconst {\n  handleSQLError\n} = require('../../../sql/error'); //GET\n\n\nconst palList = (req, res) => {\n  const {\n    user\n  } = req.params;\n  let sql = 'SELECT DISTINCT a.accessId, pL.username AS pals, pL.reqId AS palReq, pL.palList, pLS.palListName, a.pantryRole, a.shopListRole FROM palLists AS pL JOIN palListsRequests AS pLR JOIN palListsSettings AS pLS JOIN access AS a ON pLR.palRequestId=pL.reqId AND a.palReq=pL.reqId AND pL.palList=pLS.palListSettingsId WHERE pLR.approved=1 AND a.active=1 AND a.username<>? AND pLS.owner=? ORDER BY a.accessId';\n  sql = mysql.format(sql, [user, user]);\n  pool.query(sql, (err, row) => {\n    if (err) return handleSQLError(res, err);\n    return res.json(row);\n  });\n};\n\nmodule.exports = {\n  palList\n};","map":{"version":3,"sources":["/Users/moonbox/Documents/capstone/pantrypal/controller/appFunc/palLists/usersPalList.js"],"names":["mysql","require","pool","handleSQLError","palList","req","res","user","params","sql","format","query","err","row","json","module","exports"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,yBAAD,CAApB;;AACA,MAAM;AAACE,EAAAA;AAAD,IAAmBF,OAAO,CAAC,oBAAD,CAAhC,C,CAEA;;;AACA,MAAMG,OAAO,GAAG,CAACC,GAAD,EAAMC,GAAN,KAAc;AAE9B,QAAM;AAACC,IAAAA;AAAD,MAASF,GAAG,CAACG,MAAnB;AAEA,MAAIC,GAAG,GAAG,iZAAV;AAEAA,EAAAA,GAAG,GAACT,KAAK,CAACU,MAAN,CAAaD,GAAb,EAAkB,CAACF,IAAD,EAAOA,IAAP,CAAlB,CAAJ;AACAL,EAAAA,IAAI,CAACS,KAAL,CAAWF,GAAX,EAAgB,CAACG,GAAD,EAAMC,GAAN,KAAc;AAC5B,QAAGD,GAAH,EAAQ,OAAOT,cAAc,CAACG,GAAD,EAAMM,GAAN,CAArB;AACR,WAAON,GAAG,CAACQ,IAAJ,CAASD,GAAT,CAAP;AACD,GAHD;AAKC,CAZD;;AAeAE,MAAM,CAACC,OAAP,GAAiB;AACfZ,EAAAA;AADe,CAAjB","sourcesContent":["const mysql = require('mysql')\nconst pool = require('../../../sql/connection')\nconst {handleSQLError} = require('../../../sql/error')\n\n//GET\nconst palList = (req, res) => {\n\nconst {user} = req.params\n\nlet sql = 'SELECT DISTINCT a.accessId, pL.username AS pals, pL.reqId AS palReq, pL.palList, pLS.palListName, a.pantryRole, a.shopListRole FROM palLists AS pL JOIN palListsRequests AS pLR JOIN palListsSettings AS pLS JOIN access AS a ON pLR.palRequestId=pL.reqId AND a.palReq=pL.reqId AND pL.palList=pLS.palListSettingsId WHERE pLR.approved=1 AND a.active=1 AND a.username<>? AND pLS.owner=? ORDER BY a.accessId'\n\nsql=mysql.format(sql, [user, user])\npool.query(sql, (err, row) => {\n  if(err) return handleSQLError(res, err)\n  return res.json(row); \n})  \n\n}\n\n\nmodule.exports = {\n  palList\n}"]},"metadata":{},"sourceType":"script"}