{"ast":null,"code":"const mysql = require('mysql');\n\nconst pool = require('../../../sql/connection');\n\nconst {\n  handleSQLError\n} = require('../../../sql/error'); //GET \n\n\nconst justDisplayPrefer = (req, res) => {\n  let sql = 'SELECT * FROM usersDisplayPreferences WHERE username=?';\n  sql = mysql.format(sql, [req.user]);\n  pool.query(sql, (err, row) => {\n    if (err) return handleSQLError(res, err);\n    return res.json(row);\n  });\n}; //PUT \n\n\nconst updateDisplayPref = (req, res) => {\n  const {\n    likes,\n    dislikes,\n    diets,\n    allergies,\n    city,\n    state,\n    country,\n    email,\n    dobMonth,\n    dobDate,\n    dobYear,\n    phone\n  } = req.body;\n  let sql = 'UPDATE usersDisplayPreferences SET likes=COALESCE(?, likes), dislikes=COALESCE(?, dislikes), diets=COALESCE(?,diets), allergies=COALESCE(?, allergies), city=COALESCE(?, city), state=COALESCE(?, state), country=COALESCE(?, country), email=COALESCE(?, email), dobMonth=COALESCE(?, dobMonth), dobDate=COALESCE(?, dobDate), dobYear=COALESCE(?, dobYear), phone=COALESCE(?, phone)  WHERE username=?';\n  sql = mysql.format(sql, [likes, dislikes, diets, allergies, city, state, country, email, dobMonth, dobDate, dobYear, phone, req.user]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.status(204).json();\n  });\n};\n\nconst updateDisplayPrefDefault = (req, res) => {\n  console.log('reset you display preferences to the default ');\n  let sql = 'UPDATE usersDisplayPreferences SET likes=0, dislikes=0, diets=0, allergies=0, city=0, state=0, country=0, email=1, dobMonth=1, dobDate=1, dobYear=0, phone=0, private=0  WHERE username=?';\n  sql = mysql.format(sql, [req.user]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.status(204).json();\n  });\n};\n\nconst updateDisplayPrivate = (req, res) => {\n  let sql = 'UPDATE usersDisplayPreferences SET private=? WHERE username=?';\n  sql = mysql.format(sql, [req.params.boo, req.user]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.status(204).json();\n  });\n};\n\nmodule.exports = {\n  justDisplayPrefer,\n  updateDisplayPref,\n  updateDisplayPrefDefault,\n  updateDisplayPrivate\n};","map":{"version":3,"sources":["/Users/moonbox/Documents/capstone/pantrypal/controller/users/information/displayPref.js"],"names":["mysql","require","pool","handleSQLError","justDisplayPrefer","req","res","sql","format","user","query","err","row","json","updateDisplayPref","likes","dislikes","diets","allergies","city","state","country","email","dobMonth","dobDate","dobYear","phone","body","results","status","updateDisplayPrefDefault","console","log","updateDisplayPrivate","params","boo","module","exports"],"mappings":"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","sourcesContent":["const mysql = require('mysql')\nconst pool = require('../../../sql/connection')\nconst { handleSQLError } = require('../../../sql/error')\n\n//GET \nconst justDisplayPrefer = (req, res) => {\n\n  let sql = 'SELECT * FROM usersDisplayPreferences WHERE username=?'\n\n  sql=mysql.format(sql,[req.user])\n\n  pool.query(sql, (err, row) => {\n    if(err) return handleSQLError(res, err)\n    return res.json(row); \n  })  \n\n}\n\n//PUT \nconst updateDisplayPref = (req, res) => {\n  \n  const {likes, dislikes, diets, allergies, city, state, country, email, dobMonth, dobDate, dobYear, phone} = req.body\n\n  let sql='UPDATE usersDisplayPreferences SET likes=COALESCE(?, likes), dislikes=COALESCE(?, dislikes), diets=COALESCE(?,diets), allergies=COALESCE(?, allergies), city=COALESCE(?, city), state=COALESCE(?, state), country=COALESCE(?, country), email=COALESCE(?, email), dobMonth=COALESCE(?, dobMonth), dobDate=COALESCE(?, dobDate), dobYear=COALESCE(?, dobYear), phone=COALESCE(?, phone)  WHERE username=?'\n\n  sql=mysql.format(sql, [likes, dislikes, diets, allergies, city, state, country, email, dobMonth, dobDate, dobYear, phone, req.user])\n\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err)\n    return res.status(204).json();\n  })\n\n}\n\nconst updateDisplayPrefDefault = (req, res) => {\n  console.log('reset you display preferences to the default ')\n\n  let sql='UPDATE usersDisplayPreferences SET likes=0, dislikes=0, diets=0, allergies=0, city=0, state=0, country=0, email=1, dobMonth=1, dobDate=1, dobYear=0, phone=0, private=0  WHERE username=?'\n\n  sql=mysql.format(sql, [req.user])\n\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err)\n    return res.status(204).json();\n  })\n}\n\nconst updateDisplayPrivate = (req, res) => {\n\n  let sql = 'UPDATE usersDisplayPreferences SET private=? WHERE username=?'\n\n  sql=mysql.format(sql, [req.params.boo, req.user])\n\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err)\n    return res.status(204).json();\n  })\n}\n\nmodule.exports = {\n  justDisplayPrefer, \n  updateDisplayPref,\n  updateDisplayPrefDefault,\n  updateDisplayPrivate\n}"]},"metadata":{},"sourceType":"script"}