{"ast":null,"code":"const mysql = require('mysql');\n\nconst pool = require('../../../sql/connection');\n\nconst {\n  handleSQLError\n} = require('../../../sql/error'); //GET \n\n\nconst justLikes = (req, res) => {\n  let sql = 'SELECT likeId AS id, item, spoonId FROM likes WHERE active=1 AND username=?';\n  sql = mysql.format(sql, [req.user]);\n  pool.query(sql, (err, row) => {\n    if (err) return handleSQLError(res, err);\n    return res.json(row);\n  });\n}; //POST\n\n\nconst addLike = (req, res) => {\n  const {\n    item,\n    spoon\n  } = req.body;\n  let sql = 'INSERT INTO likes (username, item, spoonId) VALUES (?, ?, ?)';\n  sql = mysql.format(sql, [req.user, item, spoon]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.json({\n      likeId: results.insertId\n    });\n  });\n}; //PUT\n\n\nconst removeLike = (req, res) => {\n  const {\n    entryId\n  } = req.params;\n  let sql = 'UPDATE likes SET active=0 WHERE likeId=? AND username=?';\n  sql = mysql.format(sql, [entryId, req.user]);\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err);\n    return res.status(204).json();\n  });\n};\n\nmodule.exports = {\n  justLikes,\n  addLike,\n  removeLike\n};","map":{"version":3,"sources":["/Users/moonbox/Documents/capstone/pantrypal/controller/users/tastes/likes.js"],"names":["mysql","require","pool","handleSQLError","justLikes","req","res","sql","format","user","query","err","row","json","addLike","item","spoon","body","results","likeId","insertId","removeLike","entryId","params","status","module","exports"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,OAAD,CAArB;;AACA,MAAMC,IAAI,GAAGD,OAAO,CAAC,yBAAD,CAApB;;AACA,MAAM;AAAEE,EAAAA;AAAF,IAAqBF,OAAO,CAAC,oBAAD,CAAlC,C,CAEA;;;AACA,MAAMG,SAAS,GAAG,CAACC,GAAD,EAAMC,GAAN,KAAc;AAE9B,MAAIC,GAAG,GAAC,6EAAR;AAEAA,EAAAA,GAAG,GAACP,KAAK,CAACQ,MAAN,CAAaD,GAAb,EAAiB,CAACF,GAAG,CAACI,IAAL,CAAjB,CAAJ;AAEAP,EAAAA,IAAI,CAACQ,KAAL,CAAWH,GAAX,EAAgB,CAACI,GAAD,EAAMC,GAAN,KAAc;AAC5B,QAAGD,GAAH,EAAQ,OAAOR,cAAc,CAACG,GAAD,EAAMK,GAAN,CAArB;AACR,WAAOL,GAAG,CAACO,IAAJ,CAASD,GAAT,CAAP;AACD,GAHD;AAKD,CAXD,C,CAaA;;;AACA,MAAME,OAAO,GAAG,CAACT,GAAD,EAAMC,GAAN,KAAc;AAE5B,QAAM;AAACS,IAAAA,IAAD;AAAOC,IAAAA;AAAP,MAAgBX,GAAG,CAACY,IAA1B;AAEA,MAAIV,GAAG,GAAC,8DAAR;AAEAA,EAAAA,GAAG,GAACP,KAAK,CAACQ,MAAN,CAAaD,GAAb,EAAiB,CAAEF,GAAG,CAACI,IAAN,EAAaM,IAAb,EAAmBC,KAAnB,CAAjB,CAAJ;AAEAd,EAAAA,IAAI,CAACQ,KAAL,CAAWH,GAAX,EAAgB,CAACI,GAAD,EAAMO,OAAN,KAAkB;AAChC,QAAGP,GAAH,EAAQ,OAAOR,cAAc,CAACG,GAAD,EAAMK,GAAN,CAArB;AACR,WAAOL,GAAG,CAACO,IAAJ,CAAU;AAAEM,MAAAA,MAAM,EAAED,OAAO,CAACE;AAAlB,KAAV,CAAP;AACD,GAHD;AAKD,CAbD,C,CAeA;;;AACA,MAAMC,UAAU,GAAG,CAAChB,GAAD,EAAMC,GAAN,KAAc;AAE/B,QAAM;AAACgB,IAAAA;AAAD,MAAYjB,GAAG,CAACkB,MAAtB;AAEA,MAAIhB,GAAG,GAAC,yDAAR;AAEAA,EAAAA,GAAG,GAACP,KAAK,CAACQ,MAAN,CAAaD,GAAb,EAAiB,CAACe,OAAD,EAAUjB,GAAG,CAACI,IAAd,CAAjB,CAAJ;AAEAP,EAAAA,IAAI,CAACQ,KAAL,CAAWH,GAAX,EAAgB,CAACI,GAAD,EAAMO,OAAN,KAAkB;AAChC,QAAIP,GAAJ,EAAS,OAAOR,cAAc,CAACG,GAAD,EAAMK,GAAN,CAArB;AACT,WAAOL,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBX,IAAhB,EAAP;AACD,GAHD;AAID,CAZD;;AAeAY,MAAM,CAACC,OAAP,GAAiB;AACftB,EAAAA,SADe;AAEfU,EAAAA,OAFe;AAGfO,EAAAA;AAHe,CAAjB","sourcesContent":["const mysql = require('mysql')\nconst pool = require('../../../sql/connection')\nconst { handleSQLError } = require('../../../sql/error')\n\n//GET \nconst justLikes = (req, res) => {\n\n  let sql='SELECT likeId AS id, item, spoonId FROM likes WHERE active=1 AND username=?'\n\n  sql=mysql.format(sql,[req.user])\n\n  pool.query(sql, (err, row) => {\n    if(err) return handleSQLError(res, err)\n    return res.json(row); \n  })  \n\n} \n\n//POST\nconst addLike = (req, res) => {\n\n  const {item, spoon} = req.body\n\n  let sql='INSERT INTO likes (username, item, spoonId) VALUES (?, ?, ?)'\n\n  sql=mysql.format(sql,[ req.user , item, spoon])\n\n  pool.query(sql, (err, results) => {\n    if(err) return handleSQLError(res, err)\n    return res.json( { likeId: results.insertId} )\n  })  \n\n}\n\n//PUT\nconst removeLike = (req, res) => {\n\n  const {entryId} = req.params\n\n  let sql='UPDATE likes SET active=0 WHERE likeId=? AND username=?'\n\n  sql=mysql.format(sql,[entryId, req.user])\n\n  pool.query(sql, (err, results) => {\n    if (err) return handleSQLError(res, err)\n    return res.status(204).json();\n  })\n}\n\n\nmodule.exports = {\n  justLikes,\n  addLike,\n  removeLike  \n}"]},"metadata":{},"sourceType":"script"}